<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0a0806">
    
    <title>DARK DECKGEON</title>
    
    <!-- Dark Souls Style Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Cormorant+Garamond:wght@400;500;600&display=swap" rel="stylesheet">
    
    <style>
        /* ==================== DARK SOULS THEME ==================== */
        :root {
            --ds-black: #0a0806;
            --ds-dark: #151210;
            --ds-brown: #1a1512;
            --ds-panel: #12100d;
            --ds-gold: #c9a227;
            --ds-gold-dark: #8b7320;
            --ds-gold-glow: rgba(201, 162, 39, 0.4);
            --ds-red: #8b2020;
            --ds-red-bright: #c93030;
            --ds-blood: #6b1010;
            --ds-ember: #ff6a00;
            --ds-text: #c4b998;
            --ds-text-dim: #7a7060;
            --ds-border: #3a3020;
            --ds-border-light: #5a4a30;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: var(--ds-black);
            font-family: 'Cormorant Garamond', 'Times New Roman', serif;
            color: var(--ds-text);
            user-select: none;
            -webkit-user-select: none;
        }
        
        /* ==================== LAYOUT ==================== */
        #battle-area {
            position: relative;
            width: 100%;
            height: 65vh;
            overflow: hidden;
            background: var(--ds-black);
        }
        
        #game-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        /* ==================== TOP BAR (Dark Souls Style) ==================== */
        #top-bar {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 70px;
            background: linear-gradient(180deg, 
                rgba(10, 8, 6, 0.95) 0%, 
                rgba(10, 8, 6, 0.7) 70%, 
                transparent 100%);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 12px 20px;
            z-index: 100;
        }
        
        /* HP Section */
        .hp-section {
            display: flex;
            gap: 20px;
        }
        
        .hp-box {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .hp-box .label {
            font-family: 'Cinzel', serif;
            font-size: 10px;
            letter-spacing: 3px;
            color: var(--ds-text-dim);
            text-transform: uppercase;
        }
        
        .hp-bar-container {
            position: relative;
            width: 140px;
            height: 12px;
        }
        
        .hp-bar-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #0a0a0a;
            border: 1px solid var(--ds-border);
        }
        
        .hp-bar-fill {
            position: absolute;
            top: 1px;
            left: 1px;
            height: calc(100% - 2px);
            transition: width 0.4s ease-out;
        }
        
        .hp-bar-fill.player {
            background: linear-gradient(180deg, var(--ds-gold) 0%, var(--ds-gold-dark) 100%);
            box-shadow: 0 0 8px var(--ds-gold-glow);
        }
        
        .hp-bar-fill.enemy {
            background: linear-gradient(180deg, var(--ds-red-bright) 0%, var(--ds-blood) 100%);
        }
        
        .hp-bar-shine {
            position: absolute;
            top: 1px;
            left: 1px;
            right: 1px;
            height: 40%;
            background: linear-gradient(180deg, rgba(255,255,255,0.15) 0%, transparent 100%);
            pointer-events: none;
        }
        
        .hp-text {
            font-family: 'Cinzel', serif;
            font-size: 11px;
            color: var(--ds-text);
            margin-top: 2px;
        }
        
        /* Turn & Phase Display */
        .turn-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }
        
        #turn-display {
            font-family: 'Cinzel', serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--ds-gold);
            text-shadow: 0 0 10px var(--ds-gold-glow);
        }
        
        #phase-display {
            font-family: 'Cinzel', serif;
            font-size: 11px;
            letter-spacing: 4px;
            color: var(--ds-text);
            padding: 4px 16px;
            border: 1px solid var(--ds-border);
            background: rgba(0,0,0,0.5);
        }
        
        /* Cost/Souls Display */
        .souls-box {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 4px;
        }
        
        .souls-label {
            font-family: 'Cinzel', serif;
            font-size: 10px;
            letter-spacing: 2px;
            color: var(--ds-text-dim);
        }
        
        .souls-display {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .souls-icon {
            font-size: 20px;
            color: var(--ds-gold);
            text-shadow: 0 0 8px var(--ds-gold-glow);
        }
        
        #cost-display {
            font-family: 'Cinzel', serif;
            font-size: 24px;
            font-weight: 700;
            color: var(--ds-gold);
            text-shadow: 0 0 10px var(--ds-gold-glow);
        }
        
        /* ==================== CENTER MESSAGE ==================== */
        #center-message {
            position: absolute;
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-family: 'Cinzel', serif;
            font-size: 42px;
            font-weight: 700;
            letter-spacing: 8px;
            color: var(--ds-gold);
            text-shadow: 
                0 0 20px var(--ds-gold-glow),
                0 0 40px var(--ds-gold-glow),
                2px 2px 4px #000;
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 200;
            pointer-events: none;
            text-transform: uppercase;
        }
        
        /* ==================== CARD PANEL (Dark Souls Style) ==================== */
        #unit-panel {
            position: relative;
            width: 100%;
            height: 35vh;
            background: linear-gradient(180deg, 
                var(--ds-brown) 0%, 
                var(--ds-dark) 50%,
                var(--ds-black) 100%);
            border-top: 2px solid var(--ds-border);
            display: flex;
            flex-direction: column;
            padding: 8px 15px;
        }
        
        /* Decorative top border */
        #unit-panel::before {
            content: '';
            position: absolute;
            top: -1px;
            left: 10%;
            right: 10%;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent 0%, 
                var(--ds-gold-dark) 30%, 
                var(--ds-gold) 50%, 
                var(--ds-gold-dark) 70%, 
                transparent 100%);
        }
        
        #panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 4px 10px;
            margin-bottom: 8px;
        }
        
        #panel-title {
            font-family: 'Cinzel', serif;
            font-size: 13px;
            letter-spacing: 4px;
            color: var(--ds-text-dim);
            text-transform: uppercase;
        }
        
        #panel-header span:last-child {
            font-family: 'Cinzel', serif;
            font-size: 12px;
            color: var(--ds-text-dim);
        }
        
        /* ==================== CARD HAND ==================== */
        #card-hand {
            display: flex;
            gap: 12px;
            justify-content: center;
            padding: 8px 10px;
            flex-wrap: wrap;
            flex: 1;
            align-items: center;
        }
        
        .card {
            position: relative;
            width: 95px;
            height: 130px;
            background: linear-gradient(170deg, 
                #2a2520 0%, 
                #1a1815 50%, 
                #100e0c 100%);
            border: 2px solid var(--ds-border);
            border-radius: 4px;
            padding: 8px 6px;
            cursor: grab;
            transition: all 0.2s ease-out;
            display: flex;
            flex-direction: column;
            touch-action: none;
            box-shadow: 
                0 4px 8px rgba(0,0,0,0.6),
                inset 0 1px 0 rgba(255,255,255,0.05);
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 4px;
            left: 4px;
            right: 4px;
            bottom: 4px;
            border: 1px solid rgba(100, 80, 50, 0.3);
            border-radius: 2px;
            pointer-events: none;
        }
        
        .card:hover {
            transform: translateY(-20px) scale(1.1);
            border-color: var(--ds-gold-dark);
            box-shadow: 
                0 15px 30px rgba(0,0,0,0.8),
                0 0 20px var(--ds-gold-glow);
            z-index: 10;
        }
        
        .card:active {
            cursor: grabbing;
            transform: translateY(-25px) scale(1.12);
        }
        
        /* Card Cost (Soul Cost) */
        .card-cost {
            position: absolute;
            top: -10px;
            left: -10px;
            width: 30px;
            height: 30px;
            background: radial-gradient(circle at 30% 30%, 
                var(--ds-gold) 0%, 
                var(--ds-gold-dark) 100%);
            border: 2px solid #4a3a20;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-family: 'Cinzel', serif;
            font-weight: 700;
            font-size: 15px;
            color: #1a1510;
            box-shadow: 
                0 2px 6px rgba(0,0,0,0.5),
                inset 0 -2px 4px rgba(0,0,0,0.3);
        }
        
        .card-name {
            font-family: 'Cinzel', serif;
            font-size: 11px;
            font-weight: 600;
            text-align: center;
            margin-top: 14px;
            color: var(--ds-text);
            letter-spacing: 1px;
        }
        
        .card-type {
            font-size: 8px;
            text-align: center;
            margin-top: 3px;
            color: var(--ds-text-dim);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .card-desc {
            font-size: 9px;
            text-align: center;
            color: var(--ds-text-dim);
            margin-top: auto;
            line-height: 1.3;
        }
        
        /* Card Type Colors */
        .card.attack { border-color: var(--ds-red); }
        .card.attack:hover { border-color: var(--ds-red-bright); }
        .card.attack .card-cost { 
            background: radial-gradient(circle at 30% 30%, 
                var(--ds-red-bright) 0%, 
                var(--ds-blood) 100%);
            border-color: #4a2020;
        }
        
        .card.skill { border-color: #2a4a6a; }
        .card.skill:hover { border-color: #4080b0; }
        .card.skill .card-cost { 
            background: radial-gradient(circle at 30% 30%, 
                #4080b0 0%, 
                #203050 100%);
            border-color: #203040;
        }
        
        .card.summon { border-color: #4a3a6a; }
        .card.summon:hover { border-color: #8060b0; }
        .card.summon .card-cost { 
            background: radial-gradient(circle at 30% 30%, 
                #8060b0 0%, 
                #3a2060 100%);
            border-color: #302040;
        }
        
        /* Drag Ghost */
        .drag-card {
            background: linear-gradient(170deg, #3a3530 0%, #2a2825 50%, #1a1815 100%);
            border: 3px solid var(--ds-gold-dark) !important;
            box-shadow: 0 20px 50px rgba(0,0,0,0.8), 0 0 30px var(--ds-gold-glow);
        }
        
        /* ==================== BOTTOM BAR (Cost + Button) ==================== */
        #panel-bottom {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 20px;
        }
        
        /* Cost Display (Left) */
        .cost-display-panel {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .cost-label {
            font-family: 'Cinzel', serif;
            font-size: 11px;
            letter-spacing: 2px;
            color: var(--ds-text-dim);
        }
        
        .cost-value {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .cost-icon {
            font-size: 24px;
            color: var(--ds-gold);
            text-shadow: 0 0 10px var(--ds-gold-glow);
        }
        
        #cost-display-bottom {
            font-family: 'Cinzel', serif;
            font-size: 28px;
            font-weight: 700;
            color: var(--ds-gold);
            text-shadow: 0 0 12px var(--ds-gold-glow);
        }
        
        /* End Turn Button (Right) */
        #btn-end-turn {
            font-family: 'Cinzel', serif;
            font-size: 13px;
            font-weight: 600;
            letter-spacing: 3px;
            text-transform: uppercase;
            color: var(--ds-text);
            padding: 14px 35px;
            background: linear-gradient(180deg, 
                rgba(40, 35, 25, 0.9) 0%, 
                rgba(20, 18, 12, 0.95) 100%);
            border: 2px solid var(--ds-border);
            border-radius: 2px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }
        
        #btn-end-turn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, 
                transparent, 
                var(--ds-gold-dark), 
                transparent);
        }
        
        #btn-end-turn:hover {
            border-color: var(--ds-gold-dark);
            color: var(--ds-gold);
            box-shadow: 
                0 0 20px var(--ds-gold-glow),
                inset 0 0 20px rgba(201, 162, 39, 0.1);
        }
        
        #btn-end-turn:active {
            transform: scale(0.98);
        }
        
        /* ==================== ENEMY INTENT (Dark Souls Style) ==================== */
        .enemy-intent {
            position: absolute;
            pointer-events: none;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            transform: translateX(-50%);
            animation: intent-fade-in 0.4s ease-out;
        }
        
        @keyframes intent-fade-in {
            from { opacity: 0; transform: translateX(-50%) translateY(-15px); }
            to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }
        
        .intent-container {
            background: linear-gradient(180deg, 
                rgba(15, 12, 8, 0.95) 0%, 
                rgba(8, 6, 4, 0.9) 100%);
            border: 1px solid var(--ds-border);
            padding: 8px 14px;
            min-width: 45px;
            text-align: center;
            position: relative;
        }
        
        .intent-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 20%;
            right: 20%;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--ds-gold-dark), transparent);
        }
        
        .intent-container::after {
            content: '';
            position: absolute;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 6px solid var(--ds-border);
        }
        
        .intent-icon {
            font-size: 18px;
            display: block;
        }
        
        .intent-value {
            font-family: 'Cinzel', serif;
            font-size: 14px;
            font-weight: 700;
            display: block;
            margin-top: 2px;
        }
        
        .enemy-intent.attack .intent-icon,
        .enemy-intent.attack .intent-value {
            color: var(--ds-red-bright);
            text-shadow: 0 0 6px rgba(200, 50, 50, 0.6);
        }
        
        .enemy-intent.defend .intent-icon,
        .enemy-intent.defend .intent-value {
            color: #6090c0;
            text-shadow: 0 0 6px rgba(80, 130, 200, 0.5);
        }
        
        .enemy-intent.buff .intent-icon,
        .enemy-intent.buff .intent-value {
            color: var(--ds-gold);
            text-shadow: 0 0 6px var(--ds-gold-glow);
        }
        
        /* ==================== CHARACTER HP BARS ==================== */
        .char-hp-bar {
            position: absolute;
            pointer-events: none;
            z-index: 500;
            transform: translateX(-50%);
        }
        
        .char-hp-container {
            width: 55px;
            height: 6px;
            background: #050505;
            border: 1px solid #2a2520;
            position: relative;
        }
        
        .char-hp-fill {
            height: 100%;
            transition: width 0.3s;
        }
        
        .char-hp-bar.player .char-hp-fill {
            background: linear-gradient(180deg, var(--ds-gold) 0%, var(--ds-gold-dark) 100%);
        }
        
        .char-hp-bar.enemy .char-hp-fill {
            background: linear-gradient(180deg, var(--ds-red-bright) 0%, var(--ds-blood) 100%);
        }
        
        .char-hp-bar.summon .char-hp-fill {
            background: linear-gradient(180deg, #888 0%, #444 100%);
        }
        
        .char-hp-text {
            font-family: 'Cinzel', serif;
            font-size: 9px;
            color: var(--ds-text-dim);
            text-align: center;
            margin-top: 1px;
        }
        
        .char-hp-bar.low .char-hp-fill {
            animation: hp-flash 0.6s infinite alternate;
        }
        
        @keyframes hp-flash {
            from { opacity: 1; }
            to { opacity: 0.5; }
        }
        
        /* ==================== DRAG GHOST ==================== */
        #drag-ghost {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
        }
    </style>
</head>
<body>
    <!-- ==================== BATTLE AREA ==================== -->
    <div id="battle-area">
        <div id="game-container"></div>
        
        <!-- Top Bar -->
        <div id="top-bar">
            <div class="hp-section">
                <div class="hp-box">
                    <span class="label">ASHEN ONE</span>
                    <div class="hp-bar-container">
                        <div class="hp-bar-bg"></div>
                        <div class="hp-bar-fill player" id="player-hp-bar" style="width: 100%"></div>
                        <div class="hp-bar-shine"></div>
                    </div>
                    <span class="hp-text" id="player-hp-text">80/80</span>
                </div>
            </div>
            
            <div class="turn-box">
                <span id="turn-display">I</span>
                <span id="phase-display">PREPARE</span>
            </div>
            
            <div class="souls-box">
                <span class="souls-label">ESTUS</span>
                <div class="souls-display">
                    <span class="souls-icon">&#9733;</span>
                    <span id="cost-display">3</span>
                </div>
            </div>
        </div>
        
        <!-- Center Message -->
        <div id="center-message"></div>
    </div>
    
    <!-- ==================== CARD PANEL ==================== -->
    <div id="unit-panel">
        <div id="panel-header">
            <span id="panel-title">Spell Inventory</span>
            <span>Turn <span id="turn-display-2">1</span></span>
        </div>
        
        <!-- Card Hand -->
        <div id="card-hand">
            <!-- Cards rendered by JavaScript -->
        </div>
        
        <!-- Bottom Bar: Cost (Left) + End Turn (Right) -->
        <div id="panel-bottom">
            <div class="cost-display-panel">
                <span class="cost-label">ESTUS</span>
                <div class="cost-value">
                    <span class="cost-icon">&#9733;</span>
                    <span id="cost-display-bottom">3</span>
                </div>
            </div>
            <button id="btn-end-turn">End Turn</button>
        </div>
    </div>
    
    <!-- Drag Ghost Container -->
    <div id="drag-ghost"></div>
    
    <!-- Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/pixi.js@8.x/dist/pixi.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.2/dist/gsap.min.js"></script>
    
    <!-- DDOO Engine -->
    <script src="engine/ddoo-config.js"></script>
    <script src="engine/ddoo-background.js"></script>
    <script src="engine/ddoo-utils.js"></script>
    <script src="engine/ddoo-draw.js"></script>
    <script src="engine/vfx.js"></script>
    <script src="engine/ddoo-renderer.js"></script>
    <script src="engine/ddoo-floater.js"></script>
    <script src="engine/ddoo-action.js"></script>
    
    <!-- Effects -->
    <script src="turn-effects.js"></script>
    
    <!-- Game -->
    <script src="game.js"></script>
</body>
</html>
