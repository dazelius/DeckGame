/* ==========================================
   Shadow Deck - 반응형 시스템
   모든 해상도 대응 CSS
   ========================================== */

/* ==========================================
   CSS 변수 - 반응형 기준값
   ========================================== */
:root {
    /* 기본 스케일 (PC 1920x1080 기준) */
    --scale: 1;
    --card-scale: 1;
    --font-scale: 1;
    --spacing-scale: 1;
    
    /* 카드 크기 */
    --card-width: 178px;
    --card-height: 259px;
    --card-gap: 15px;
    
    /* 캐릭터 크기 */
    --player-size: 200px;
    --enemy-normal-size: 180px;
    --enemy-elite-size: 270px;
    --enemy-boss-size: 360px;
    
    /* UI 요소 크기 */
    --top-bar-height: 50px;
    --bottom-area-height: 280px;
    --energy-orb-size: 80px;
    --pile-size: 70px;
    
    /* 폰트 크기 */
    --font-xs: 0.7rem;
    --font-sm: 0.85rem;
    --font-md: 1rem;
    --font-lg: 1.2rem;
    --font-xl: 1.5rem;
    --font-xxl: 2rem;
    
    /* 간격 */
    --gap-xs: 5px;
    --gap-sm: 10px;
    --gap-md: 15px;
    --gap-lg: 20px;
    --gap-xl: 30px;
}

/* ==========================================
   해상도 클래스 (JS에서 동적 적용)
   ========================================== */

/* 초소형 (320px 미만) */
.res-tiny {
    --scale: 0.5;
    --card-scale: 0.5;
    --font-scale: 0.7;
}

/* 소형 모바일 (320px ~ 480px) */
.res-mobile-sm {
    --scale: 0.65;
    --card-scale: 0.6;
    --font-scale: 0.8;
    --card-width: 140px;
    --card-height: 200px;
    --energy-orb-size: 60px;
    --pile-size: 55px;
}

/* 모바일 (481px ~ 767px) */
.res-mobile {
    --scale: 0.75;
    --card-scale: 0.7;
    --font-scale: 0.9;
    --card-width: 150px;
    --card-height: 210px;
    --energy-orb-size: 65px;
    --pile-size: 60px;
}

/* 태블릿 (768px ~ 1023px) */
.res-tablet {
    --scale: 0.8;
    --card-scale: 0.75;
    --font-scale: 0.9;
}

/* 소형 PC (1024px ~ 1365px) */
.res-laptop {
    --scale: 0.85;
    --card-scale: 0.85;
    --font-scale: 0.95;
}

/* 일반 PC (1366px ~ 1919px) */
.res-desktop {
    --scale: 1;
    --card-scale: 1;
    --font-scale: 1;
}

/* 대형 모니터 (1920px+) */
.res-large {
    --scale: 1.1;
    --card-scale: 1.1;
    --font-scale: 1.05;
}

/* 초대형 모니터 (2560px+) */
.res-xlarge {
    --scale: 1.25;
    --card-scale: 1.2;
    --font-scale: 1.1;
}

/* 4K (3840px+) */
.res-4k {
    --scale: 1.5;
    --card-scale: 1.4;
    --font-scale: 1.2;
}

/* ==========================================
   높이 기반 클래스
   ========================================== */

/* 매우 낮은 높이 (400px 미만) */
.height-tiny {
    --bottom-area-height: 140px;
    --top-bar-height: 35px;
    --card-height: 120px;
}

/* 낮은 높이 (400px ~ 600px) */
.height-low {
    --bottom-area-height: 180px;
    --top-bar-height: 40px;
    --card-height: 150px;
}

/* 중간 높이 (600px ~ 800px) */
.height-medium {
    --bottom-area-height: 220px;
    --top-bar-height: 45px;
}

/* 일반 높이 (800px+) */
.height-normal {
    --bottom-area-height: 280px;
    --top-bar-height: 50px;
}

/* ==========================================
   반응형 유틸리티 클래스
   ========================================== */

/* 모바일에서만 표시 */
body .mobile-only {
    display: none;
}

body.res-mobile-sm .mobile-only,
body.res-mobile .mobile-only {
    display: block;
}

/* 데스크탑에서만 표시 */
body .desktop-only {
    display: block;
}

body.res-mobile-sm .desktop-only,
body.res-mobile .desktop-only,
body.res-tablet .desktop-only {
    display: none;
}

/* ==========================================
   게임 컨테이너 반응형
   ========================================== */
.game-container {
    transform-origin: center center;
}

/* 스케일 적용 (컨테이너 크기 기반) */
.game-container.scaled {
    transform: scale(var(--scale));
}

/* ==========================================
   상단 바 반응형
   ========================================== */
.top-bar {
    height: var(--top-bar-height);
    padding: calc(var(--gap-sm) * var(--scale)) calc(var(--gap-lg) * var(--scale));
    font-size: calc(var(--font-md) * var(--font-scale));
}

.floor-text,
.turn-indicator {
    font-size: calc(var(--font-lg) * var(--font-scale));
}

/* ==========================================
   전투 영역 반응형
   ========================================== */
.battle-arena {
    padding: calc(var(--gap-lg) * var(--scale));
    padding-bottom: 70px; /* 카드 영역과 분리 */
    gap: calc(var(--gap-xl) * var(--scale));
}

/* 플레이어 크기 */
.player-character,
.character-container#player {
    transform: scale(var(--scale));
    transform-origin: center bottom;
}

/* 적 크기 - 등급별 스케일 유지 */
.enemy-unit {
    transform: scale(var(--scale));
    transform-origin: center bottom;
}

.enemy-unit.minion {
    transform: scale(calc(var(--scale) * 0.7));
}

.enemy-unit.elite {
    transform: scale(calc(var(--scale) * 1.2));
}

.enemy-unit.boss {
    transform: scale(calc(var(--scale) * 1.4));
}

/* ==========================================
   하단 영역 반응형
   ========================================== */
.bottom-area {
    height: var(--bottom-area-height);
    padding: calc(var(--gap-md) * var(--scale));
}

/* 에너지 오브 */
.energy-orb {
    width: calc(var(--energy-orb-size) * var(--scale));
    height: calc(var(--energy-orb-size) * var(--scale));
    font-size: calc(var(--font-xl) * var(--font-scale));
}

/* 덱 파일 */
.deck-pile {
    width: calc(var(--pile-size) * var(--scale));
    height: calc(var(--pile-size) * 1.3 * var(--scale));
    font-size: calc(var(--font-sm) * var(--font-scale));
}

/* ==========================================
   카드 반응형
   ========================================== */
.card {
    width: calc(var(--card-width) * var(--card-scale));
    height: calc(var(--card-height) * var(--card-scale));
    font-size: calc(var(--font-sm) * var(--font-scale));
}

.card-cost {
    position: absolute;
    top: -8px;
    left: -8px;
    width: calc(38px * var(--card-scale));
    height: calc(38px * var(--card-scale));
    font-size: calc(1.2rem * var(--font-scale));
    z-index: 10;
}

.card-icon {
    font-size: calc(3.2rem * var(--card-scale));
}

.card-icon-img {
    width: calc(64px * var(--card-scale));
    height: calc(64px * var(--card-scale));
}

.card-name {
    font-size: calc(var(--font-md) * var(--font-scale));
}

.card-description {
    font-size: calc(var(--font-xs) * var(--font-scale));
    padding: calc(var(--gap-xs) * var(--scale));
}

/* 손패 영역 */
.hand-area {
    padding: 0 calc(var(--gap-xl) * var(--scale));
}

.hand {
    gap: calc(var(--card-gap) * var(--card-scale));
}

/* ==========================================
   HP 바 반응형
   ========================================== */
.hp-bar {
    height: calc(24px * var(--scale));
    font-size: calc(var(--font-sm) * var(--font-scale));
}

.hp-text {
    font-size: calc(var(--font-sm) * var(--font-scale));
}

/* 방어도 표시 */
.block-display {
    transform: scale(var(--scale));
}

/* ==========================================
   인텐트 반응형
   ========================================== */
.enemy-intent {
    font-size: calc(var(--font-lg) * var(--font-scale));
    padding: calc(var(--gap-xs) * var(--scale)) calc(var(--gap-sm) * var(--scale));
}

/* ==========================================
   모달 반응형
   ========================================== */
.modal-content {
    width: calc(100% - calc(var(--gap-xl) * 2 * var(--scale)));
    max-width: calc(500px * var(--scale));
    padding: calc(var(--gap-xl) * var(--scale));
    font-size: calc(var(--font-md) * var(--font-scale));
}

.modal-content h2 {
    font-size: calc(var(--font-xxl) * var(--font-scale));
}

/* ==========================================
   배틀 로그 반응형
   ========================================== */
.battle-log {
    width: calc(200px * var(--scale));
    max-height: calc(150px * var(--scale));
    font-size: calc(var(--font-xs) * var(--font-scale));
}

/* ==========================================
   END TURN 버튼 반응형
   ========================================== */
.end-turn-btn {
    width: calc(90px * var(--scale));
    height: calc(90px * var(--scale));
    font-size: calc(var(--font-md) * var(--font-scale));
}

/* ==========================================
   미디어 쿼리 - 폴백 (JS 비활성화 시)
   ========================================== */

/* 초대형 모니터 (2560px+) */
@media (min-width: 2560px) {
    :root {
        --scale: 1.25;
        --card-scale: 1.2;
        --font-scale: 1.1;
    }
}

/* 대형 모니터 (1920px ~ 2559px) */
@media (min-width: 1920px) and (max-width: 2559px) {
    :root {
        --scale: 1.1;
        --card-scale: 1.1;
        --font-scale: 1.05;
    }
}

/* 일반 PC (1366px ~ 1919px) */
@media (min-width: 1366px) and (max-width: 1919px) {
    :root {
        --scale: 1;
        --card-scale: 1;
        --font-scale: 1;
    }
}

/* 소형 PC / 노트북 (1024px ~ 1365px) */
@media (min-width: 1024px) and (max-width: 1365px) {
    :root {
        --scale: 0.85;
        --card-scale: 0.85;
        --font-scale: 0.95;
    }
    
    .battle-arena {
        gap: 30px;
    }
}

/* 태블릿 (768px ~ 1023px) */
@media (min-width: 768px) and (max-width: 1023px) {
    :root {
        --scale: 0.8;
        --card-scale: 0.75;
        --font-scale: 0.9;
        --bottom-area-height: 220px;
    }
    
    .battle-arena {
        flex-direction: column;
        gap: 20px;
    }
    
    .enemy-side {
        order: -1;
    }
}

/* 모바일 가로 (481px ~ 767px) */
@media (min-width: 481px) and (max-width: 767px) {
    :root {
        --scale: 0.7;
        --card-scale: 0.65;
        --font-scale: 0.85;
        --bottom-area-height: 180px;
        --top-bar-height: 40px;
    }
    
    .battle-arena {
        padding: 10px;
    }
    
    .hand {
        gap: 5px;
    }
    
    .card {
        margin: 0 -10px;
    }
}

/* 모바일 세로 (320px ~ 480px) */
@media (max-width: 480px) {
    :root {
        --scale: 0.65;
        --card-scale: 0.6;
        --font-scale: 0.8;
        --bottom-area-height: 180px;
        --top-bar-height: 40px;
    }
    
    .battle-arena {
        flex-direction: column;
        padding: 8px;
        gap: 10px;
    }
    
    .hand {
        gap: 3px;
    }
    
    .card {
        margin: 0 -12px;
        min-width: 75px;
        min-height: 110px;
    }
    
    .battle-log {
        display: none;
    }
    
    /* 에너지 오브 크기 조정 */
    .energy-orb {
        width: 55px !important;
        height: 55px !important;
        font-size: 1.1rem !important;
    }
    
    /* End Turn 버튼 크기 */
    .end-turn-btn {
        width: 70px !important;
        height: 70px !important;
        font-size: 0.85rem !important;
    }
    
    /* HP 바 */
    .hp-bar {
        height: 22px !important;
    }
    
    /* 상단 바 컴팩트 */
    .top-bar {
        padding: 5px 10px;
    }
    
    .floor-text, .turn-indicator {
        font-size: 0.9rem;
    }
}

/* 초소형 모바일 (320px 미만) */
@media (max-width: 319px) {
    :root {
        --scale: 0.5;
        --card-scale: 0.5;
        --font-scale: 0.7;
        --bottom-area-height: 140px;
        --top-bar-height: 30px;
    }
}

/* ==========================================
   높이 기반 미디어 쿼리
   ========================================== */

/* 매우 낮은 높이 (모바일 가로) */
@media (max-height: 400px) {
    :root {
        --bottom-area-height: 140px;
        --top-bar-height: 35px;
    }
    
    .card {
        height: calc(120px * var(--card-scale));
    }
    
    .card-description {
        display: none;
    }
    
    .battle-log {
        display: none;
    }
}

/* 낮은 높이 */
@media (min-height: 401px) and (max-height: 600px) {
    :root {
        --bottom-area-height: 180px;
        --top-bar-height: 40px;
    }
    
    .card {
        height: calc(150px * var(--card-scale));
    }
}

/* 중간 높이 */
@media (min-height: 601px) and (max-height: 800px) {
    :root {
        --bottom-area-height: 220px;
        --top-bar-height: 45px;
    }
}

/* ==========================================
   가로/세로 모드
   ========================================== */

/* 세로 모드 (Portrait) */
@media (orientation: portrait) {
    .battle-arena {
        flex-direction: column;
        justify-content: flex-start;
        padding-top: 10px;
    }
    
    .enemy-side {
        order: -1;
        transform: scale(0.8);
        transform-origin: center top;
    }
    
    .player-side {
        transform: scale(0.85);
        transform-origin: center bottom;
    }
    
    .vs-divider {
        display: none;
    }
    
    /* 손패 영역 조정 */
    .bottom-area {
        padding: 5px 10px;
    }
    
    .hand-area {
        padding: 0 5px;
    }
    
    /* 카드 겹침 조정 */
    .hand .card {
        margin: 0 -8px;
    }
}

/* 세로 모드 + 모바일 */
@media (orientation: portrait) and (max-width: 600px) {
    /* 전투 영역 컴팩트화 */
    .battle-arena {
        min-height: 40vh;
        max-height: 50vh;
    }
    
    /* 캐릭터 크기 축소 */
    .player-character,
    .character-container#player {
        transform: scale(0.7);
    }
    
    .enemy-unit {
        transform: scale(0.65);
    }
    
    /* 하단 영역 확대 (카드 보이게) */
    .bottom-area {
        height: auto;
        min-height: 150px;
        max-height: 200px;
    }
    
    /* 카드 크기 조정 */
    .card {
        width: 70px !important;
        height: 100px !important;
        font-size: 0.65rem !important;
    }
    
    .card-cost {
        width: 24px !important;
        height: 24px !important;
        font-size: 0.8rem !important;
        top: -5px !important;
        left: -5px !important;
    }
    
    .card-name {
        font-size: 0.6rem !important;
        padding: 2px !important;
    }
    
    .card-description {
        display: none !important;
    }
    
    .card-icon, .card-icon-img {
        width: 32px !important;
        height: 32px !important;
        font-size: 1.5rem !important;
    }
}

/* 가로 모드 (Landscape) */
@media (orientation: landscape) {
    .battle-arena {
        flex-direction: row;
    }
}

/* ==========================================
   세이프 에어리어 (노치 대응)
   ========================================== */
@supports (padding: env(safe-area-inset-top)) {
    .game-container {
        padding-top: env(safe-area-inset-top);
        padding-bottom: env(safe-area-inset-bottom);
        padding-left: env(safe-area-inset-left);
        padding-right: env(safe-area-inset-right);
    }
    
    .top-bar {
        padding-top: max(10px, env(safe-area-inset-top));
    }
    
    .bottom-area {
        padding-bottom: max(10px, env(safe-area-inset-bottom));
    }
}

/* ==========================================
   터치 디바이스 최적화
   ========================================== */
@media (hover: none) and (pointer: coarse) {
    /* 터치 타겟 최소 크기 (48px 권장) */
    .card {
        min-height: 120px;
        min-width: 85px;
    }
    
    .end-turn-btn {
        min-width: 80px;
        min-height: 80px;
        font-size: 1rem !important;
    }
    
    .deck-pile {
        min-width: 55px;
        min-height: 70px;
    }
    
    .energy-orb {
        min-width: 60px;
        min-height: 60px;
    }
    
    /* 모든 버튼 터치 영역 확대 */
    button, .clickable, [onclick] {
        min-height: 44px;
        min-width: 44px;
    }
    
    /* 호버 효과 비활성화 */
    .card:hover {
        transform: none;
    }
    
    /* 탭 피드백 강화 */
    .card:active,
    .end-turn-btn:active,
    .deck-pile:active,
    button:active {
        transform: scale(0.92);
        opacity: 0.85;
        transition: transform 0.1s, opacity 0.1s;
    }
    
    /* 상태바 요소 크기 확대 */
    .hp-bar {
        min-height: 28px;
    }
    
    .block-display {
        min-width: 40px;
        min-height: 40px;
    }
    
    /* 인텐트 크기 확대 */
    .enemy-intent {
        min-width: 50px;
        min-height: 50px;
        font-size: 1.2rem;
    }
}

/* ==========================================
   화면 회전 안내 오버레이
   ========================================== */
.rotate-overlay {
    position: fixed;
    inset: 0;
    background: linear-gradient(135deg, #1a1a2e 0%, #0f0f1a 100%);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    z-index: 99999;
    color: #e2e8f0;
}

.rotate-icon {
    font-size: 4rem;
    animation: rotatePhone 2s ease-in-out infinite;
    margin-bottom: 20px;
}

@keyframes rotatePhone {
    0%, 100% { transform: rotate(0deg); }
    25% { transform: rotate(-30deg); }
    75% { transform: rotate(30deg); }
}

.rotate-text {
    font-family: 'Cinzel', serif;
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 10px;
}

.rotate-subtext {
    font-size: 1rem;
    color: #a0aec0;
}

/* ==========================================
   디버그 모드 (개발용)
   ========================================== */
.debug-responsive::after {
    content: 'W: ' attr(data-width) ' H: ' attr(data-height) ' | ' attr(data-res-class);
    position: fixed;
    top: 5px;
    right: 5px;
    background: rgba(0, 0, 0, 0.8);
    color: #00ff00;
    padding: 5px 10px;
    font-size: 12px;
    font-family: monospace;
    border-radius: 4px;
    z-index: 99999;
    pointer-events: none;
}

/* ==========================================
   접근성 - 움직임 감소 모드
   (접근성을 위해 최고 우선순위 필요)
   ========================================== */
@media (prefers-reduced-motion: reduce) {
    html body *,
    html body *::before,
    html body *::after {
        animation-duration: 0.01ms;
        animation-iteration-count: 1;
        transition-duration: 0.01ms;
    }
}

/* ==========================================
   고대비 모드
   ========================================== */
@media (prefers-contrast: high) {
    :root {
        --bg-primary: #000000;
        --text-bright: #ffffff;
        --accent-crimson: #ff0000;
        --accent-gold: #ffff00;
    }
    
    .card {
        border-width: 3px;
    }
}

/* ==========================================
   다크 모드 (기본이 다크)
   ========================================== */
@media (prefers-color-scheme: light) {
    /* 라이트 모드 지원 시 여기에 추가 */
    /* 현재는 다크 모드 전용 */
}

/* [Responsive CSS] 로드 완료 */

